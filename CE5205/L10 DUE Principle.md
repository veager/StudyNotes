# Traffic Assignment - Deterministic User Equilibrium (DUE) Principle

## 1. Introduction

### 1.1 Classical four-step transport Planning model

Considering a zoning and network system, collection/ coding of planning, calibration and validation data. Data include base year levels for population of different types in each zone of the study area as well as levels of economic activity including employment, shopping space, educational and recreational facilities.

**Trip generation**: Estimate total number of trips produced and attracted by each zone of the study area.

**Trip distribution**: Allocation of these trips to particular destinations, i.e. their distribution over space.

**Modal split**: Travel mode choice.

**Traffic assignment and transit assignment**: Assignment of trips by each travel mode to corresponding networks: typically auto and public transport.

### 1.2 Traffic Assignment Models for Auto Mode

**Inputs:** the OD trip matrix $[q_{rs}]_{Z \times Z}$ for auto mode that is generated by a modal split model.

**Outputs:** traffic flow/volume of auto mode on each link/road segment.

**Traffic Assignment Models:**  A traffic assignment model aims to distribute auto mode trips $q_{rs}$ from zone $r$ (i.e., origin $r$) to zone $s$ (i.e., destination $s$ ) over the links of a transportation network based on the route choice principles of travelers/users.

After completion of three steps – trip generation, trip distribution and modal split, number of trips by auto mode from an origin to a destination (O-D demand) during a peak hour is come out.

**Remarks:** Behavior of drivers/travelers in route choice should be first investigated!

## 2. Link Travel Time Functions

### 2.1 Relation between Travel Time and Traffic Flow

Average travel time on link $a$, $t_a(x_a)$, should be **non-decreasing** in its link flow $x_a$ and **non-increasing** in its capacity $C_a$, namely,
$$
t_a'(x_a) = \frac{\mathrm{d} \, t_a(x_a)}{\mathrm{d} \, x_a} \geq 0
\qquad
t_a'(C_a) = \frac{\mathrm{d} \, t_a(x_a, C_a)}{\mathrm{d} \, C_a} \leq 0
$$
where:
- Link $a$: A road segment with travel direction
- Link flow $x_a$: Number of vehicles passing though the link per unit time
- Link capacity $C_a$: Maximum number of vehicles that can traverse the link per unit time

### 2.2 BRP Functions

BRP (Bureau of Public Roads, 1964) function
$$
t_a(x_a) = t_a^0 \times \left[1.0 + \alpha_a (x_a / C_a)^{\beta_a} \right]
$$
where:
- $t_a^0 = t_a(x_a=0)$ is free-flow travel time on link $a$
- Parameters $\alpha_a$, $\beta_a$ should be calibrated from real data
- Typical values of parameters $\alpha_a = 0.15$ and $\beta_a = 4$

## 3. Deterministic User Equilibrium (DUE) Principle

### 3.1 Behavioral Principle of Drivers/travelers in Route Choice

- It is reasonable to assume that every traveler (vehicle) will try to minimize her/his own **travel time** when traveling from origin $r$ to destination $s$

- That is, travelers will aim to travel on the "shortest path" (i.e., fastest path) from origin $r$ to destination $s$.

- This does not mean that all the travelers between the same OD pair should be assigned on a single path.

**Travel time on a path depends on the traffic flow of the path**

### 3.2 Wardrop's First Principle (DUE conditions)

> **Wardrop's First Principle**: The journey time on all the routes actually used are equal, and less than those which would be experienced by a single vehicle on any unused route (Wardrop, 1952)

Three Alternative Descriptions:

- That is: No traveler can improve his / her travel time by unilaterally changing routes

- That is: For each OD pair, at DUE, travel time on all used paths is equal, and less than or **equal** to travel time that would be experienced by a single vehicle on any unused path.

- That is: For each OD pair, at DUE, all used paths have equal travel time, and travel time on **an unused path** between the O-D pair will not less than that on the used paths.

**Assumptions**

- Travelers will have rational behavior **in route choice** (utility maximization, in this case, use the shortest path, actually the fastest path)

- Travelers have **full (perfect) information** about roadway conditions.

- Travelers are identical in terms of route choice behavior.

## 4. Mathematical Formulation

### 4.1 Graph Representation of Transportation Network

- $G=(N, A)$: graph
- $N$: set of nodes
- $A$: set of links
- Two subsets of set $N$
  - $R \subset N$: set of origins (i.e., centroids)
  - $S \subset N$: set of destinations (i.e., centroids)
- $K_{rs}$: set of paths from origin $r$ to destination $s$

### 4.2 Feasible Path Flow Solutions

**Link/Path Incidence Matrix** $\Delta = [\delta_{ak}^{rs}]$
$$
\delta_{ak}^{rs} = \begin{cases}
1 & \text{If link $a$ is on path $k$ between O-D pair $r$-$s$} \\
0 & \text{Otherwise}
\end{cases}
$$

**Traffic flow on path** $k$ from origin $r$ to destination $s$:
$$
f_{k}^{rs}, \quad \forall \ k \in K_{rs}, \forall \ r \in R, \forall \ s \in S
$$

**Flow conservation equations**
$$
\sum_{k \in K_{rs}}f_{k}^{rs} = q_{rs} \ ,
\quad \forall r \in R, \ \forall s \in S
$$

**Non-negativity constraints**
$$
f_{k}^{rs} \geq 0 \ ,
\quad \forall k \in K_{rs}, \ \forall \ r \in R, \ \forall \ s \in S
$$

### 4.3 Feasible Link Flow Solutions

A generic formulation of **link flow**
$$
x_a = \sum_{r \in R} \sum_{s \in S} \sum_{k \in K_{rs}} \delta_{ak}^{rs} \cdot f_{k}^{rs},
\quad \forall \ a \in A
$$

### 4.4 Path Travel Time Functions

**Travel time function of a path** is defined as sum of travel times of all links defining the path
$$
c_k^{rs} = \sum_{a \in A} \delta_{ak}^{rs} \cdot t_a(x_a),
\quad \forall \ k \in K_{rs}, \forall \ r \in R, \forall \ s \in S
$$

### 4.5 Mathematical Formulation of DUE

> No travelers can improve his/her travel time by unilaterally changing routes

Mathematically, we can say that find **a feasible path flow solution** that satisfies:

$$
\begin{align*}
f_{k}^{rs} \times (c_{k}^{rs} - u^{rs}) &= 0, \quad \forall \ k \in K_{rs}, \forall \ r \in R, \forall \ s \in S
\\
c_{k}^{rs} \geq u^{rs} &\geq 0, \quad \forall \ k \in K_{rs}, \forall \ r \in R, \forall \ s \in S
\\
f_{k}^{rs} &\geq 0, \quad \forall \ k \in K_{rs}, \forall \ r \in R, \forall \ s \in S
\end{align*}
$$

Where $u^{rs}$ is shortest path cost (travel time) from original $r$ to destination $s$.

Note that this is a **complementarity constraints**.

## 5. Convex Minimization Model for DUE Principle

### 5.1 Beckmann's Formulation

Beckmann's Formulation (Beckmann, 1952)

- A **strictly convex programming** model in terms of **link flows** $x_a$

- No transportation implication for the objective function

  The objective function is the sum of the integrals of the link performance functions. This function **does not have any intuitive economic or behavioral interpretation**. It should be viewed strictly as a mathematical construct that is utilized to solve equilibrium problems.

$$
\begin{array}{rll}
\displaystyle \min_{\boldsymbol{x}} z(\boldsymbol{x}) = & \displaystyle \sum_{a \in A}\int_0^{x_a} t_a(\omega) \ \mathrm{d}\omega
\\
\text{s.t.} \quad & \displaystyle x_a = \sum_{r \in R} \sum_{s \in S} \sum_{k \in K_{rs}} \delta_{ak}^{rs} \cdot f_{k}^{rs},
& \forall \ a \in A
\\
& \displaystyle \sum_{k \in K_{rs}}f_{k}^{rs} = q_{rs} \ ,
& \forall r \in R, \ \forall s \in S
\\
& \displaystyle f_{k}^{rs} \geq 0 \ ,
& \forall k \in K_{rs}, \ \forall \ r \in R, \ \forall \ s \in S
\end{array}
$$

Regrading to the objective item $\displaystyle \int_0^{x_a} t_a(\omega) \ \mathrm{d}\omega$, if we employ the BPR travel time function $t_a(x_a) = t_a^0 \times \left[1.0 + \alpha_a (x_a / C_a)^{\beta_a} \right]$ (where $t_a^0, \alpha_a, \beta_a, C_a$ are constants), then we have
$$
\int_0^{x_a} t_a(\omega) \ \mathrm{d}\omega
= \left. \left[t_a^0 \, \omega + \frac{t_a^0 \ \alpha_a}{\beta_a+1} \left( \frac{\omega ^{\ \beta_a + 1}}{C_a^{\beta_a}} \right)  + \text{constant}\right] \right|_{0}^{x_a}
= t_a^0 \, x_a + \frac{t_a^0 \ \alpha_a}{\beta_a+1} \left( \frac{x_a ^{\ \beta_a + 1}}{C_a^{\beta_a}} \right)
$$

Useful Derivatives
$$
\begin{align*}
\frac{\partial z(\boldsymbol{x})}{\partial x_a} &
  = \frac{\partial z(\boldsymbol{f})}{\partial x_a}
  = t_a(x_a), \quad \forall \, a \in A
\\
\frac{\partial z(\boldsymbol{x})}{\partial \boldsymbol{x}} &
  = \sum_{a \in A} t_a(x_a)
\\
\frac{\partial x_a}{\partial f_k^{rs}} &
  = \delta_{ak}^{rs}
\\
\frac{\partial z(\boldsymbol{f})}{\partial f^{rs}_k} &
  = \sum_{a \in A} \frac{\partial z(\boldsymbol{f})}{\partial x_a} \frac{\partial x_a}{\partial f_k^{rs}}
  = \sum_{a \in A} t_a(x_a) \, \delta_{ak}^{rs}
\\
\frac{\partial \, t_a(x_a)}{\partial f^{rs}_{k}} &
  = \frac{\partial \, t_a(x_a)}{\partial x_a} \frac{\partial \, x_a}{\partial f^{rs}_{k}}
  = t_a'(x_a) \, \delta_{ak}^{rs}
\end{align*}
$$


### 5.2 Equivalent Fomulation with respect to Path Flows

Fomulation of $z(\boldsymbol{f})$ in terms of **path flows** $f^{rs}_k$. Equivalence with DUE conditions:
$$
\begin{array}{rll}
\displaystyle \min_{\boldsymbol{f}} z(\boldsymbol{f}) =
  & \displaystyle \sum_{a \in A} \int_0 ^{
    \textstyle { \sum \limits_{r \in R}} \ {\sum \limits_{s \in S}} \ {\sum \limits_{k \in K_{rs}}
    } \delta_{ak}^{rs} \cdot f_{k}^{rs} }
t_a(\omega) \ \mathrm{d} \omega
\\
\text{s.t.} \quad & \displaystyle \sum_{k \in K_{rs}}f_{k}^{rs} = q_{rs} \ ,
& \forall r \in R, \ \forall s \in S
\\
& \displaystyle f_{k}^{rs} \geq 0 \ ,
& \forall k \in K_{rs}, \ \forall \ r \in R, \ \forall \ s \in S
\end{array}
$$

### 5.3 Proof using KKT conditions

(1) Build the Lagrangian function for the equivalent minimization model
$$
L \left(\boldsymbol{f}, \boldsymbol{u}, \boldsymbol{\nu} \right)
= z(\boldsymbol{f}) + \sum_{r \in R} \sum_{s \in S} u_{rs} \left(q_{rs} - \sum_{k \in K_{rs}}f_{k}^{rs} \right)
+ \sum_{r \in R} \sum_{s \in S} \sum_{k \in K_{rs}} \nu^{kr}_{s} \cdot \left( - f_{k}^{rs} \right)
$$
where $u_{rs}$ and $\nu^{kr}_{s}$ are Lagrangian multipliers.

(2) Assume that $\left\{ f_{k}^{*rs} \ | \ \forall  k \in K_{rs}, r \in R, s \in S \right\}$ is the optimal solution. There exist Lagrangian multipliers $\left\{u_{rs}^* \in R \ | \  r \in R, s \in S\right\}$, $\left\{ \nu^{*rs}_k \geq 0 \ | \ \forall  k \in K_{rs}, r \in R, s \in S \right\}$ such that:

$$\begin{array}{lrl}
\displaystyle \frac{\partial L \left(\boldsymbol{f}^*, \boldsymbol{u}, \boldsymbol{\nu} \right)}{\partial f^{*rs}_k} = \frac{\partial z(\boldsymbol{f^*})}{f^{*rs}_k} - u_{rs}^* - \nu^{*rs}_k =0,
  & \forall k \in K_{rs}, \ \forall \ r \in R, \ \forall \ s \in S
\\
\nu^{*rs}_k \geq 0,
  & \forall k \in K_{rs}, \ \forall \ r \in R, \ \forall \ s \in S
\\
\displaystyle \nu^{*rs}_k \cdot \frac{\partial L \left(\boldsymbol{f}^*, \boldsymbol{u}, \boldsymbol{\nu} \right)}{\nu^{*rs}_k} = \nu^{*rs}_k \times (-f^{*rs}_k) = 0,
  & \forall k \in K_{rs}, \ \forall \ r \in R, \ \forall \ s \in S
\\
\displaystyle \sum_{k \in K_{rs}} f^{*rs}_k = q_{rs}
  & \forall \ r \in R, \ \forall \ s \in S
\\
f^{*rs}_k \geq 0,
  & \forall \ r \in R, \ \forall \ s \in S
\end{array}$$

Then, we can get
$$\begin{array}{lr}
  \nu^{*rs}_k =  c^{*rs}_k - u^{*}_{rs} \\
  \nu^{*rs}_k + u^{*rs}_k = c^{*rs}_k \geq u^{*}_{rs} \\
  (c^{*rs}_k - u^{*}_{rs}) f^{*rs}_k = 0
\end{array}$$

where:
$$
\frac{\partial z(\boldsymbol{f^*})}{f^{*rs}_k}
= \sum_{a \in A} t_a (x_a^*) \ \delta^{rs}_{ak}
= c^{*rs}_k
$$

### 5.4 Situations of Solution

#### (1) **Uniqueness** of DUE **Link Flow** Solution

The Beckmann's formulation in terms of link flows, $z(\boldsymbol{x})$, is a **strictly convex** minimization problem, and its Hessian matrix $\nabla^2 z(\boldsymbol{x})$ is **positive definite**.

The Hessian matrix of objective function $z(\boldsymbol{x})$:
$$
\nabla z(\boldsymbol{x}) = \begin{bmatrix}
  t_1(x_1) \\
  t_2(x_2) \\
  \vdots   \\
  t_a(x_a)
\end{bmatrix}
\qquad \qquad
\nabla^2 z(\boldsymbol{x}) = \begin{bmatrix}
  t_1'(x_1) & 0 & \cdots & 0 \\
  0 & t_2'(x_2) & \cdots & 0 \\
  \vdots & \vdots & \ddots & 0 \\
  0 & 0  & \cdots & t_a'(x_a)
\end{bmatrix}
$$

#### (2) **Non-uniqueness** of DUE **Path Flow** Solution

The Beckmann's formulation in terms of path flows, $z(\boldsymbol{f})$,  is a **convex but not strictly convex** programming problem.

Firstly, consider the first-order derivative of function $z(\boldsymbol{f})$:
$$
\nabla z(\boldsymbol{f}) = \begin{bmatrix}
  \vdots   \\
  \sum_{a \in A} t_a(x_a) \, \delta_{ak}^{rs}\\
  \vdots   \\
\end{bmatrix}
$$
Where a set $(r,s,k)$ indicates a unique column index of the vector $\nabla z(\boldsymbol{f})$. Then, the $\big[(r,s,k), (r',s',k') \big]$ entry of Hessian matrix $\nabla^2 z(\boldsymbol{x})$ is:

$$
\frac{\partial}{\partial f^{r's'}_{k'}} \frac{\partial z(\boldsymbol{f})}{\partial f^{rs}_k}
= \frac{\partial}{\partial f^{r's'}_{k'}} \left[ \sum_{a \in A} t_a(x_a) \, \delta_{ak}^{rs} \right]
= \sum_{a \in A} \delta_{ak}^{rs} \left[\frac{\partial \, t_a(x_a)}{\partial f^{r's'}_{k'}} \right]
= \sum_{a \in A} \delta_{ak}^{rs} \, \delta_{ak'}^{r's'} t_{a}^{\prime}(x_a)
$$
Thus, we can get $\nabla^2 z(\boldsymbol{x})$ is a symmetric matrix, however, we can not guarantee Hessian matrix $\nabla^2 z(\boldsymbol{x})$ always is positive definite.

## 6. Heuristic Equilibration Techniques

### 6.1 All-or-Nothing Traffic Assignment Method

**Input:** Link travel times (is a constant, not a function)

**Output:** Link flow solution

**Method** :

- **Step 1:** For each O-D pair, apply the shortest-path algorithm to find the shortest path; load the traffic demand between the O-D pair onto the shortest path.

- **Step 2:** Traffic flow on a link is calculated by adding traffic flows of all paths using the link.

### 6.2 Capacity Restraint Method

#### (1) Simple Capacity Restraint Method

Capacity restraint method involves a repetitive all-or-nothing assignment in which the travel times resulting from the previous assignment are used in the current iteration.

**Step 0: Initialization.** Perform all-or-nothing assignment based on $t_a^0=t_a(0), \forall \, a$. Obtain a set of link flows $\{x_a^0\}$. Set iteration counter $n := 1$.

**Step 1: Update.** Set $t_a^n = t_a(x_a^{n-1}), \forall \, a$.

**Step 2: Network loading.** Assign all trips to the network using all-or-nothing based on travel times $\{t_a^n\}$. This yields a set of link flows $\{x_a^n\}$.

**Step 3: Convergence test.** If $\displaystyle \max_a  \{|x_a^{n} - x_a^{n-1}|\} \leq \varepsilon$ stop (the current set of link flows is the solution). Otherwise, set $n=n+1$ and go to **Step 1**.

This method is difficult to converge.

#### (2) FHWA's Capacity Restraint Method

U.S. Federal Highway Administration (FHWA) refined this method.

- First, instead of using the travel time obtained in the previous iteration for the new loading, a combination of the last two travel times obtained is used. This introduces a "smoothing" effect.

- Second, the failure to converge is recognized explicitly and the algorithm is terminated after a given number of iterations, $N$.

- The equilibrium flow pattern is then taken to be the average flow for each link over the last four iterations (obviously, $N$ should never be less than 4).

**Step 0: Initialization.** Perform an all-or-nothing assignment based on $t_a^0=t_a(0), \forall \, a$. Obtain a set of link flows $\{x_a^0\}$. Set iteration counter $n := 1$.

**Step 1: Update.** Set $\tau_a = t_a(x_a^{n-1}), \forall a$.

**Step 2: Smoothing.** Set $t_a^n = 0.75 \, t_a^{n-1} + 0.25 \, \tau_a, \forall a$.

**Step 3: Network loading.** Perform **all-or-nothing assignment** based on travel times $\{t_a^n\}$. This yields a set of link flows $\{x_a^n\}$.

**Step 4: Stopping rule.** If $n = N$, go to **Step 5**. Otherwise, set $n:=n+1$ and go to **Step 1**.

**Step 5: Averaging.** Set $x_a^*=\frac{1}{4} \sum_{i=0}^3 x_a^{n-i}, \forall a$ and stop. ($\{x_a^*\}$ are the link flows at equilibrium.)

### 6.3 Incremental Assignment

Incremental assignment method is to assign a portion of the origin-destination matrix at each iteration. The travel times are then updated and an additional portion of the O-D matrix is loaded onto the network. In this manner, the general shape of the link performance functions can be "traced" with the successive assignments.

**Step 0: Preliminaries.** Divide each origin-destination entry into $N$ equal portions (i.e. set $q_{rs}^n = q_{rs}/N)$. Set $n:= 1$ and $x_a^0=0, \forall a$.

**Step 1: Update.** Set $t_a^n = t_a(x_a^{n-1}), \forall a$.

**Step 2: Incremental loading.** Perform all-or-nothing assignment based on $\{t_a^n\}$, but using only the trip rates q for each O-D pair. This yields a link flow pattern $\{w_a^n\}$.

**Step 3: Flow summation.** Set $x_a^n = x_a^{n-1} + w^{n}_a, \forall a$.

**Step 4: Stopping rule.** If $n = N$, stop (the current set of link flows is the solution); otherwise, set $n:=n+1$ and go to **Step 1**.

**Remarks:** the **heuristic methods** either do not converge or produce a set of flows that is not in agreement with the user-equilibrium criterion.

## 7. Solution Algorithms

### 7.1 Frank-Wolfe Method

- The Frank-Wolfe method was made popular in traffic assignment by the work of LeBlanc et al (1975) (Ref. [8]).

- It was validated by Florian and Nguyen (1976) (Ref. [9]).

- It is now the most common approach used by transportation planning software packages to DUE traffic assignment problems

  - Transportation Planning Software Package: Visum, EMME, TransCAD

#### Algorithmic Steps

**Step 0 (Initialization) :** Perform all-or-nothing traffic assignment based on $\{t_a = t_a(0), a \in A\}$. This yields $\{x_a^{(1)}, a \in A \}$. Set counter $n:=1$

**Step 1: (Update) :** Set $t_a^{(n)} = t_a(x_a^{(n)}), \forall \, a \in A$

**Step 2: (Direction finding) :** Perform all-or-nothing traffic assignment based on $\{x_a^{(n)}, a \in A \}$. This yields a set of (auxiliary) flows $\{y_a^{(n)}, a \in A\}$

**Step 3: (Line search) :** Find $\alpha_n$ that solves
$$
\alpha_n = \min_{0 \leq \alpha \leq 1} \sum_{a \in A} \int_0^{x_a^{(n)} \ + \alpha \left[y_a^{(n)} \ - \ x_a^{(n)} \ \right]} t_a(\omega) \ \mathrm{d} \omega
$$
where $\{y_a^{(n)} - x_a^{(n)}, \forall a \in A \}$ is descent direction.

**Step 4: (Move) :**
$$
x_a^{(n+1)} = x_a^{(n)} + \alpha_n \left( y_a^{(n)} - x_a^{(n)} \right), \forall a \in A
$$

**Step 5: (Convergence test) :** If a convergence criterion is met, then stop. The current solution,
$$
\{x_a^{(n+1)}, a \in A \} \ ,
$$
is the set of equilibrium flows.

Otherwise set $n := n+1$ and go to **Step 1**.

#### Stop Criteria

- (1)
$$
\left|\sum_{a \in A} \int_{0}^{x_{a}^{(n)}} t_{a}(\omega) \mathrm{d} \omega-\sum_{a \in A} \int_{0}^{x_{a}^{(n+1)}} t_{a}(\omega) \mathrm{d} \omega \right| \leq \varepsilon
$$

- (2)
$$
\sum_{r \in R} \sum_{s \in S} \frac{\left|u_{r s}^{(n+1)}-u_{r s}^{(n)}\right|}{u_{r s}^{(n)}} \leq \varepsilon
$$

where $u^{(n)}_{rs}$ denotes the minimum path travel time between O-D pair from $r$ to $s$ at the $n$th iteration.

- (3)
$$
\frac{\displaystyle \sqrt{\sum_{a \in A}\left(x_{a}^{(n+1)}-x_{a}^{(n)}\right)^{2}}}{\displaystyle \sum_{a \in A} x_{a}^{(n)}} \leq \varepsilon
$$

### 7.2 Method of Successive Average

- The MSA was tailored by Sheffi and Powell (1982) (Ref.[10]) for conducting traffic assignment

- The global convergence of MSA was investigated by Robbins and Monro (1951) (Ref.[11]) and Blum (1954)  (Ref.[12])

#### Algorithmic Steps

**Step 0 (Initialization) :** Perform all-or-nothing traffic assignment based on $\{t_a = t_a(0), a \in A\}$. This yields $\{x_a^{(1)}, a \in A \}$. Set counter $n:=1$

**Step 1: (Update) :** Set $t_a^{(n)} = t_a(x_a^{(n)}), \forall \, a \in A$

**Step 2: (Direction finding) :** Perform all-or-nothing traffic assignment based on $\{t_a^{(n)}, a \in A \}$. This yields a set of (auxiliary) flows $\{y_a^{(n)}, a \in A\}$

**Step 3: (Line search) :** Set step size
$$
\alpha_n = \frac{1}{n}
$$

**Step 4: (Move) :**
$$
x_a^{(n+1)} = x_a^{(n)} + \alpha_n \left( y_a^{(n)} - x_a^{(n)} \right), \forall a \in A
$$

**Step 5: (Convergence test) :** If a convergence criterion is met, then stop. The current solution,
$$
\{x_a^{(n+1)}, a \in A \} \ ,
$$
is the set of equilibrium flows.

Otherwise set $n := n+1$ and go to **Step 1**.

**Stop Criteria:** Same as Frank-Wolfe method

**Remark:** Frank-Wolfe method is more efficient in terms of computational time than MSA

### 7.3 Other DUE Traffic Assignment Methods

- Path-based Algorithm: Dial (2006, Ref.[13])

- Origin-based Algorithm: Bar-Gera (2002, Ref.[14])

- Path-based Gradient Projection Algorithm: Jayakrishnan et al. (1994, Ref.[15])

- Benchmark Examples: Transportation Networks, github, [website](https://github.com/bstabler/TransportationNetworks)


## Reference

[1] J. de D. Ortúzar S. and L. G. Willumsen, "Chapter 10 Assignment" and "Chapter 11 Equilibrium and Dynamic Assignment", in *Modelling Transport, Fourth edition*. Chichester, West Sussex, United Kingdom: John Wiley & Sons, 2011.

[2] "Section 4.11 Highway Assignment", in *NCHRP Report 716 Travel Demand Forecasting: Parameters and Techniques*. Washington, D.C: National Academies Press, 2012, p.p. 72-77. Free download from this [website](http://nap.edu/14665).

[3] "Chapter 7: User Model PrT" and "Chapter 22: Settings for the PrT User Model", in *PTV Visum 2022 Manual*.

[4] Y. Sheffi, "Section 1.3, Sections 3.1-3.3, Sections 5.2-5.3", in *Urban Transportation Networks: Equilibrium Analysis with Mathematical Programming Methods*, Englewood Cliffs, N.J: Prentice-Hall, 1984. Free download from this [website](https://sheffi.mit.edu/book/urban-transportation-networks)

[5] Bureau of Public Roads, Traffic Assignment Manual for Application with a Large, High Speed Computer, US Department of  Commerce, Bureau of Public Roads, Office of Planning, Urban  Planning Division, Washington DC. 1964.

[6] J. G. Wardrop, Some Theoretical Aspects of Road Traffic Research, *Proceedings of the Institution of Civil Engineers Part I*, vol. 1, no. 3, pp. 325–362, May 1952, doi: 10.1680/ipeds.1952.11259.

[7] M. Beckmann, C. B. McGuire, C. B. Winsten, "Chapter 3 Equilibrium", in *Studies in the Economics of Transportation*, New Haven: Yale University Press, 1956. Free download from this [website](https://cowles.yale.edu/sites/default/files/files/pub/misc/specpub-beckmann-mcguire-winsten.pdf)

[8] L. J. LeBlanc, E. K. Morlok, and W. P. Pierskalla, "An efficient approach to solving the road network equilibrium traffic assignment problem", *Transportation Research*, vol. 9, no. 5, pp. 309–318, Oct. 1975, doi: 10.1016/0041-1647(75)90030-1.

[9] M. Florian and S. Nguyen, "An Application and Validation of Equilibrium Trip Assignment Methods", *Transportation Science*, vol. 10, no. 4, pp. 374–390, Nov. 1976, doi: 10.1287/trsc.10.4.374.

[10] Y. Sheffi and W. B. Powell, "An algorithm for the equilibrium assignment problem with random link times", *Networks*, vol. 12, no. 2, pp. 191–207, 1982, doi: 10.1002/net.3230120209.

[11] H. Robbins and S. Monro, "A Stochastic Approximation Method", *Ann. Math. Statist.*, vol. 22, no. 3, pp. 400–407, Sep. 1951, doi: 10.1214/aoms/1177729586.

[12] J. R. Blum, "Multidimensional Stochastic Approximation Methods", *Ann. Math. Statist.*, vol. 25, no. 4, pp. 737–744, Dec. 1954, doi: 10.1214/aoms/1177728659.

[13] R. B. Dial, "A path-based user-equilibrium traffic assignment algorithm that obviates path storage and enumeration", *Transportation Research Part B: Methodological*, vol. 40, no. 10, pp. 917–936, Dec. 2006, doi: 10.1016/j.trb.2006.02.008.

[14] H. Bar-Gera, "Origin-Based Algorithm for the Traffic Assignment Problem", *Transportation Science*, vol. 36, no. 4, pp. 398–417, Nov. 2002, doi: 10.1287/trsc.36.4.398.549.

[15] R. Jayakrishnan, W. K. Tsai, Joseph N Prashker, and S. Rajadyaksha, "A Faster Path-Based Algorithm for Traffic Assignment", *Transportation Research Record*, no. 1443, pp. 75–83, 1994.

[16] Transportation Networks for Research Core Team, *Transportation Networks for Research*, March, 23, 2022, [website](https://github.com/bstabler/TransportationNetworks).
